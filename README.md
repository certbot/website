# Certbot Website

Website for [EFF's Certbot](https://certbot.eff.org/) project. Uses Jekyll for static site generation.

[![Build Status](https://travis-ci.com/certbot/website.svg?branch=master)](https://travis-ci.com/certbot/website)

## Development

### Building with Travis

If you're developing directly on this repository rather than on a fork, it's probably easiest to let Travis build the site for you.

All branches and pull requests are built and tested by Travis.

For branches, the built assets are pushed to an analagous branch in [certbot/website-builds](https://github.com/certbot/website-builds). Built assets from PRs are not saved because Travis doesn't provide a mechanism to securely push to a Github repo after PRs across forks.

To view the build of any branch, use the script `website-builds.sh`, which will fetch the branch from certbot/website-builds and start a docker to serve the files.

```
./website-builds.sh <NAME OF BRANCH>
```

After starting that command, you can access the website in your browser at http://localhost:8000. To shut the server down, just hit Ctrl+C in the terminal where `website-builds.sh` is running.

If you are on linux and your user is not a member of the docker group, you'll need to run the command with `sudo`.

### Building locally

#### Install
1. Install `ruby 2.0+`, `node 8.0+`, and `npm 2.0+`.
2. `gem install jekyll` (requires v3.0 or higher)
3. `sudo npm install gulp-cli -g`
4. `npm install`

If you want to build a copy of the documentation for your local mirror of the
Cerbot website, also do:

5. `git submodule init`
6. `git submodule update`
7. `./_docs.sh depend`
8. Install `pdflatex` e.g. via `sudo apt install texlive texlive-latex-extra`

#### Run
To *watch* for changes and reload assets as needed via BrowserSync:
`gulp watch`

To *build* the site once:
`gulp build`

To build for production (minified javascript, no source maps):
`gulp build --env production`
The environment can also be set in the NODE_ENV environment variable. See https://github.com/gunpowderlabs/gulp-environments.

## Editing content

### Basic pages
Most pages can be edited as markdown files.

Use `/index.html` to edit the homepage.
Use `/[RELATIVE_URL]/index.html` to edit internal pages.

### Hosting providers list

- Make sure to fill out the `name`, `link`, `category`, and `reviewed` fields.
- `reviewed` should be a date in format `2019.7.11`.
- `link` is usually a link to the provider's main page; it's where clicking on the name will go.
- for `category`, see descriptions [here](https://certbot.eff.org/hosting_providers/).
- for `full`/`partial` categories, one of the links provided should have evidence of being in that category.
 - only one of `tutorial`, `announcement`, `plan` will show up, in that order.
  - `partial` should have `tutorial`.
  - `full` providers shouldn't need a tutorial to turn on https. an exception might include instructions of what to do if something goes wrong and the automatic https doesn't work.
- if one provider offers multiple products, either split into two entries or note it in the `note` field.
- the `note` field is good for things like noting which products have https, or that the site is available only in certain languages. it's not meant for advertising.
- all unused fields should be `""`

### Installation instructions

Are generated by JavaScript with
[Mustache](https://mustache.github.io/mustache.5.html), and can be edited in
`_scripts/instruction-widget`.

### FAQ
FAQ entries are a Jekyll collection. Add FAQ entries (question and answer pairs) as markdown files to the `_faq_entries` directory.

FAQ entries require two variables to be set in the [front matter](https://jekyllrb.com/docs/frontmatter/):

* title: the "Question" the FAQ entry answers
* weight: the position of this entry on the page - lighter FAQ entries will float to the top.

## Testing
Certbot/website uses [html-proofer](https://github.com/gjtorikian/html-proofer) to validate the html output of the build.

To install:
```
gem install html-proofer
```

To run the tests:
```
npm test
```
(Files with known issues are ignored.)
